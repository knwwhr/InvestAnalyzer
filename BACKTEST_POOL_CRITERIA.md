# 백테스트 종목 Pool 선정 기준

## 🎯 목적

변화율 기반 점수 체계의 효과를 검증하기 위한 **일관되고 대표성 있는** 종목 풀 확보

---

## 📋 선정 기준 (v1.0)

### 1. 기본 필터링

| 기준 | 값 | 이유 |
|------|-----|------|
| **최소 점수** | 20점 이상 (D등급+) | 신호가 전혀 없는 종목 제외 |
| **최소 거래대금** | 5억원 이상 | 유동성 확보, 실제 매매 가능 |
| **최소 거래량** | 10만주 이상 | 거래량 지표 신뢰도 확보 |
| **ETF/ETN** | 제외 | 개별 종목 패턴 분석 목적 |

### 2. 등급별 할당 (총 30개 목표)

```
목표 분포 (백테스트 검증된 비율 기반):

S등급 (58-88점):   3-5개   (10-15%)
A등급 (42-57점):   8-10개  (25-30%)
B등급 (25-41점):   12-15개 (40-50%)
C등급 (89+점):     0-2개   (과열, 참고용)
D등급 (<25점):     제외

━━━━━━━━━━━━━━━━━━━━━━━
총 30개 종목
```

**이유:**
- B등급이 가장 많은 샘플 (백테스트에서 45개, 승률 77.8%)
- A등급 안정적 성과 (승률 86.7%)
- S등급은 적지만 포함 (승률 100%, 샘플 부족 검증용)

### 3. 점수 범위 세분화

| 점수 범위 | 목표 개수 | 백테스트 특성 |
|-----------|-----------|---------------|
| 58-88점 (S) | 3-5개 | 승률 100%, 샘플 부족 |
| **42-57점 (A)** | 8-10개 | 승률 86.7%, 수익 +24.87% |
| **30-41점 (B상)** | 6-8개 | 승률 89.3%, 수익 +27.5% ⭐ |
| **25-29점 (B하)** | 6-7개 | 초기 신호, 변화율 테스트용 |
| 89+점 (C) | 0-2개 | 과열 참고용 |

### 4. 업종 다양성 (선택 사항)

```
최소 3개 업종 이상 포함:
- 바이오/제약 (백테스트에서 고수익)
- 기술/IT (변동성 높음)
- 제조/화학 (안정성)
- 기타 (여행, 건설 등)
```

### 5. 시총 범위 (선택 사항)

```
- 소형주 (<3000억): 15-20개 (변동성 높음, 변화율 감지 용이)
- 중형주 (3000억-1조): 5-10개 (안정성)
- 대형주 (1조+): 0-5개 (참고용, 삼성전자 등)
```

---

## 🔄 선정 프로세스

### Step 1: 전체 종목 스크리닝

```bash
# 53개 종목 풀에서 스크리닝
node backend/screening.js screenAllStocks('ALL')
```

### Step 2: 기본 필터링

```javascript
const candidates = allStocks.filter(s =>
  s.totalScore >= 20 &&                    // 최소 점수
  s.volume >= 100000 &&                     // 최소 거래량
  (s.currentPrice * s.volume) >= 500000000  // 최소 거래대금 5억
);
```

### Step 3: 등급별 샘플링

```javascript
const pool = [
  ...getTopN(candidates.filter(s => s.totalScore >= 58 && s.totalScore <= 88), 5),  // S등급 최대 5개
  ...getTopN(candidates.filter(s => s.totalScore >= 42 && s.totalScore <= 57), 10), // A등급 최대 10개
  ...getTopN(candidates.filter(s => s.totalScore >= 30 && s.totalScore <= 41), 8),  // B상 최대 8개
  ...getTopN(candidates.filter(s => s.totalScore >= 25 && s.totalScore <= 29), 7),  // B하 최대 7개
];

// 총 30개 목표
```

### Step 4: 스냅샷 저장

```bash
node capture-backtest-stocks-v2.js
# → backtest-pool-v2.json 생성
```

---

## 📊 선정 결과 검증 체크리스트

선정 후 다음 항목 확인:

- [ ] 총 종목 수: 25-35개
- [ ] 등급 분포: S(3-5), A(8-10), B(12-15)
- [ ] 점수 범위: 25-88점 고르게 분포
- [ ] 거래대금: 모두 5억원 이상
- [ ] 거래량: 모두 10만주 이상
- [ ] 업종: 최소 3개 이상
- [ ] 중복 없음: stockCode unique

---

## 🎯 성공 기준

**변화율 시스템이 성공했다고 판단하는 기준:**

```
변화율 구현 전 vs 후 비교:

1. 25-41점 (B등급) 종목의 평균 점수 상승:
   Before: 32.91점
   After:  45점+ (⬆️ 12점 이상 상승)
   → S등급 진입률 30% 이상

2. 42-57점 (A등급) 종목의 평균 점수 상승:
   Before: 46.06점
   After:  55점+ (⬆️ 9점 이상 상승)
   → S등급 진입률 50% 이상

3. 58-88점 (S등급) 종목의 점수 유지/하락:
   Before: 60점대
   After:  50-60점 (⬇️ 약간 하락 OK)
   → "이미 급등" 종목은 변화율 낮음
```

**핵심:**
- 변화율이 높은 종목 = 높은 점수
- 이미 급등한 종목 = 변화율 낮아 점수 하락
- 백테스트 우승자(25-41점)가 S등급으로 상승!

---

## 📝 변경 이력

### v1.0 (2025-11-18)
- 초기 기준 정의
- 백테스트 결과 기반 등급 분포 설정
- 최소 필터링 기준 설정

---

**작성일**: 2025-11-18
**작성자**: Claude Code
**목적**: 변화율 기반 점수 체계 검증을 위한 일관된 종목 풀 확보
